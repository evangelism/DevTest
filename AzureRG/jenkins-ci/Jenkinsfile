pipeline {
   agent any
    properties([
            parameters(
                [   
                    string(defaultValue: '', description: 'Azure Account Username', name: 'azure_username'),
                    string(defaultValue: '', description: 'Azure Tenant', name: 'azure_tenant'), 
                    password(defaultValue: '', description: 'Azure Account Password', name: 'azure_password')
                ]
            ), 
            pipelineTriggers([])
        ])
 
    stage ('Creating infrastructure with Azure Template') {
        git branch: 'master', url: 'https://github.com/evangelism/DevTest.git'
        dir('AzureRG/jenkins-ci/') {
            sh "./deploy-template.sh ${params.azure_username} ${params.azure_password} ${params.azure_tenant}"
        }
    }

    stage ('Publishing Sample App') {
        dir('SampleApp') {
            git branch: 'master', url: 'https://github.com/easkerov/DotNetSampleAppBinaries.git'
            sh "./ftp-upload.sh ../DevTestRG/open-wb-infra/ ."  
        }
    }
}